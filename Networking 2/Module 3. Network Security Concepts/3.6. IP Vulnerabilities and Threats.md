## 3.6.1 Video - Common IP and ICMP Attacks
There are even more types of attacks than the ones discussed in the previous topics. Some specifically target IP vulnerabilities, as you will learn in this topic.

Click Play in the figure to view a video about common IP and ICMP attacks.
![[Pasted image 20241017131011.png]]
![[Pasted image 20241017131024.png]]![[Pasted image 20241017131039.png]]
![[Pasted image 20241017131054.png]]![[Pasted image 20241017131127.png]]

## 3.6.2 IPv4 and IPv6
IP does not validate whether the source IP address contained in a packet actually came from that source. For this reason, threat actors can send packets using a spoofed source IP address. Threat actors can also tamper with the other fields in the IP header to carry out their attacks. Security analysts must understand the different fields in both the IPv4 and IPv6 headers.

Some of the more common IP related attacks are shown in the table.

| IP Attack Techniques                     | Description                                                                                                                                                                                                                                                |
| ---------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ICMP**                                 | Threat actors use Internet Control Message Protocol (ICMP) echo packets (pings) to discover subnets and hosts on a protected network, to generate DoS flood attacks, and to alter host routing tables.                                                     |
| **Amplification and reflection attacks** | Threat acotrs attempt to prevent legitimate users from accessing information or services usign DoS and DDoS attacks.                                                                                                                                       |
| **Address spoofing attacks**             | Threat actors spoofing the source UP address in an UP packet to perform bling spoofing or non-bling spoofing.                                                                                                                                              |
| **Man-in-the-middle attack (MITM)**      | Threat actors position themselves between a source and destination to transparently monitor, capture, and control the communication. They could eavesdrop by inspecting captured packets, or alter packets and forward them to their original destination. |
| **Session hijacking**                    | Threat actors gain access to the physical network, and then use an MITM attack to hijack a session.                                                                                                                                                        |
## 3.6.3 ICMP Attacks
Threat actors use ICMP for reconnaissance and scanning attacks. They can launch information-gathering attacks to map out a network topology, discover which hosts are active (reachable), identify the host operating system (OS fingerprinting), and determine the state of a firewall. Threat actors also use ICMP for DoS attacks.

**Note:** ICMP for IPv4 (ICMPv4) and ICMP for IPv6 (ICMPv6) are susceptible to similar types of attacks.

Networks should have strict ICMP access control list (ACL) filtering on the network edge to avoid ICMP probing from the internet. Security analysts should be able to detect ICMP-related attacks by looking at captured traffic and log files. In the case of large networks, security devices such as firewalls and intrusion detection systems (IDS) detect such attacks and generate alerts to the security analysts.

Common ICMP messages of interest to threat actors are listed in the table.

| ICMP Messages used by Hackers        | Description                                                                                                        |
| ------------------------------------ | ------------------------------------------------------------------------------------------------------------------ |
| **ICMP echo request and echo reply** | This is used to perform host verification and DoS attacks.                                                         |
| **ICMP unreachable**                 | This is used to perform network reconnaissance and scanning attakcs.                                               |
| **ICMP mask reply**                  | This is used to map an internal IP network.                                                                        |
| **ICMP redirects**                   | This is used to lure a target host into sending all traffic through a compromised device and create a MITM attack. |
| **ICMP router discovery**            | This is used to inject bogus route entries into the routing table of a target host.                                |
## 3.6.4 Video - Amplification, Reflection, and Spoofing Attacks
![[Pasted image 20241017132435.png]]
![[Pasted image 20241017132602.png]]
![[Pasted image 20241017132655.png]]

## 3.6.5 Amplification and Reflection Attacks
Threat actors often use amplification and reflection techniques to create DoS attacks. The example in the figure illustrates how an amplification and reflection technique called a Smurf attack is used to overwhelm a target host.
![[Pasted image 20241017132859.png]]1. 
1. **Amplification** - The threat actor forwards ICMP echo request messages to many hosts. These messages contain the source IP address of the victim.
2. **Reflection** - These hosts all reply to the spoofed IP address of the victim to overwhelm it.

**Note:** Newer forms of amplification and reflection attacks such as DNS-based reflection and amplification attacks and Network Time Protocol (NTP) amplification attacks are now being used.

Threat actors also use resource exhaustion attacks. These attacks consume the resources of a target host to either to crash it or to consume the resources of a network.

## 3.6.6 Address Spoofing Attacks
IP address spoofing attacks occur when a threat actor creates packets with false source IP address information to either hide the identity of the sender, or to pose as another legitimate user. The threat actor can then gain access to otherwise inaccessible data or circumvent security configurations. Spoofing is usually incorporated into another attack such as a Smurf attack.

Spoofing attacks can be non-blind or blind:

- **Non-blind spoofing** - The threat actor can see the traffic that is being sent between the host and the target. The threat actor uses non-blind spoofing to inspect the reply packet from the target victim. Non-blind spoofing determines the state of a firewall and sequence-number prediction. It can also hijack an authorized session.
- **Blind spoofing** - The threat actor cannot see the traffic that is being sent between the host and the target. Blind spoofing is used in DoS attacks.

MAC address spoofing attacks are used when threat actors have access to the internal network. Threat actors alter the MAC address of their host to match another known MAC address of a target host, as shown in the figure. The attacking host then sends a frame throughout the network with the newly-configured MAC address. When the switch receives the frame, it examines the source MAC address.

### Threat Actor Spoofs a Server’s MAC Address
![[Pasted image 20241017133102.png]]
The switch overwrites the current CAM table entry and assigns the MAC address to the new port, as shown in the figure. It then forwards frames destined for the target host to the attacking host.\

### Switch Updates CAM Table with Spoofed Address
![[Pasted image 20241017133148.png]]
Application or service spoofing is another spoofing example. A threat actor can connect a rogue DHCP server to create an MITM condition.


## 3.6.7 Check Your Understanding - IP Vulnerabilities and Threats
### Question 1

Which attack is being used when threat actors position themselves between a source and destination to transparently monitor, capture, and control the communication?
Address Spoofing Attack

Amplification and Reflection Attacks

ICMP Attack

MiTM Attack (Correct)

Session Hijacking

### Question 2

Which attack is being used when threat actors gain access to the physical network, and then use an MiTM attack to capture and manipulate a legitimate user’s traffic?

Address Spoofing Attack

Amplification and Reflection Attacks

ICMP Attack

MiTM Attack

Session Hijacking (Correct)

### Question 3

Which attack is being used when threat actors initiate a simultaneous, coordinated attack from multiple source machines?

Address Spoofing Attack

Amplification and Reflection Attacks (Correct)

ICMP Attack

MiTM Attack

Session Hijacking

### Question 4

Which attack is being used when threat actors use pings to discover subnets and hosts on a protected network, to generate flood attacks, and to alter host routing tables?

Address Spoofing Attack

Amplification and Reflection Attacks

ICMP Attack (Correct)

MiTM Attack

Session Hijacking

### Question 5

Which attack being used is when a threat actor creates packets with false source IP address information to either hide the identity of the sender, or to pose as another legitimate user?

Address Spoofing Attack (Correct)

Amplification and Reflection Attacks

ICMP Attack

MiTM Attack

Session Hijacking